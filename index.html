<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Perfume Lab Pro - Ø§Ù„Ù…ØµÙ…Ù… Ø§Ù„Ø¹Ø·Ø±ÙŠ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Cairo:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{--gold:#d4af37;--bg:#000;--card:#111;--input:#1a1a1a;}
body{font-family:'Cairo',sans-serif;background:var(--bg);color:#fff;margin:0;padding-bottom:170px;direction:rtl; touch-action: manipulation;}
.header{text-align:center;padding:30px;border-bottom:1px solid #222;}
.header h1{font-family:'Amiri',serif;color:var(--gold);font-size:30px;margin:0;}
.container{padding:15px;max-width:600px;margin:auto;}
.card{background:var(--card);border-radius:20px;padding:22px;margin-bottom:20px;border:1px solid #222;}
.section-title{color:var(--gold);font-size:16px;font-weight:700;margin-bottom:15px;border-right:4px solid var(--gold);padding-right:12px;}
.question-block {margin-bottom: 25px;}
.question-label {display: block; font-size: 14px; color: #fff; margin-bottom: 12px; font-weight: bold; line-height: 1.6;}
.options-grid {display: flex; flex-wrap: wrap; gap: 8px;}
.option-box {flex: 1; min-width: 100px; background: var(--input); border: 1px solid #333; padding: 12px 8px; border-radius: 10px; text-align: center; font-size: 11px; cursor: pointer; transition: 0.3s; color: #bbb;}
.option-box.selected {background: rgba(212, 175, 55, 0.15); border-color: var(--gold); color: var(--gold); font-weight: bold;}
.option-box.promo {border: 1px solid #27ae60; color: #27ae60;}
.option-box.promo.selected {background: rgba(39, 174, 96, 0.2); border-color: #2ecc71; color: #fff;}
select, input[type="text"], input[type="tel"], textarea {width:100%; background:var(--input); border:1px solid #333; color:#fff; padding:14px; border-radius:12px; font-family:'Cairo'; box-sizing:border-box; outline:none; margin-bottom:15px;}
/* ØªØµÙ…ÙŠÙ… Ù„ÙˆØ­Ø© Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ */
#signature-pad { border: 1px dashed var(--gold); background: #fff; border-radius: 10px; cursor: crosshair; touch-action: none; width: 100%; height: 150px; }
.sig-controls { display: flex; justify-content: space-between; margin-top: 10px; }
.btn-clear { background: #444; color: #fff; border: none; padding: 5px 15px; border-radius: 5px; font-size: 12px; cursor: pointer; }
.price-bar{position:fixed;bottom:0;left:0;right:0;background:rgba(10,10,10,.98);backdrop-filter:blur(15px);padding:20px;border-top:1px solid var(--gold);display:flex;justify-content:space-between;align-items:center;z-index:1000;}
.total-price{font-size:24px;font-weight:700;color:var(--gold);}
.btn-order{background:var(--gold);color:#000;border:none;padding:15px 35px;border-radius:12px;font-weight:700;cursor:pointer;}
</style>
</head>
<body>

<div class="header">
    <h1>PERFUME LAB PRO</h1>
    <p style="color:#666;font-size:12px;">MÃ‰DÃ‰A - Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ø±ÙˆØ§Ø¦Ø­ Ø§Ù„Ø´Ø®ØµÙŠØ© | IngÃ©nierie des Parfums</p>
</div>

<div class="container">
    <div class="card">
        <div class="section-title">ğŸ”¬ Ù…ÙŠØ«Ø§Ù‚ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø´Ø§Ù…Ù„ | Protocole d'Analyse</div>
        <div id="questions-container"></div>
    </div>

    <div id="rec-card" class="card" style="border: 1px solid var(--gold); display: none;">
        <div class="section-title">âœ¨ Ø§Ù„Ø¹Ø·Ø± Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ Ø§Ù„Ù…Ù‚ØªØ±Ø­ | Parfum SuggÃ©rÃ©</div>
        <div class="options-grid" id="rec-list"></div>
        <input type="hidden" id="chosenPerfume" value="">
    </div>

    <div class="card">
        <div class="section-title">âœï¸ ØªÙˆÙ‚ÙŠØ¹Ùƒ Ø§Ù„Ø´Ø®ØµÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø±ÙˆØ±Ø© | Votre Signature</div>
        <label class="question-label">Ø§Ù„Ø§Ø³Ù… Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø±ÙˆØ±Ø© | Nom sur le flacon</label>
        <input type="text" id="bottleName" placeholder="Ex: Ahmed / Sarah">
        
        <label class="question-label">ÙˆÙ‚Ø¹ Ø¨ÙŠØ¯Ùƒ Ù‡Ù†Ø§ | Signez ici avec votre doigt</label>
        <canvas id="signature-pad"></canvas>
        <div class="sig-controls">
            <span style="font-size: 10px; color: #666;">Ø³ÙŠØªÙ… Ù†Ù‚Ø´ Ù‡Ø°Ø§ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø¨Ø¯Ù‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø¬Ø§Ø¬</span>
            <button class="btn-clear" onclick="clearSig()">Ù…Ø³Ø­ | Effacer</button>
        </div>
    </div>

    <div class="card">
        <div class="section-title">ğŸ“ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ§Ù„Ø´Ø­Ù† | Commande & Livraison</div>
        <div class="options-grid" id="size-options">
            <div class="option-box selected" onclick="selectSize(this, 500)">30ml (500 DA)</div>
            <div class="option-box" onclick="selectSize(this, 700)">50ml (700 DA)</div>
            <div class="option-box" onclick="selectSize(this, 1000)">100ml (1000 DA)</div>
            <div class="option-box promo" onclick="selectSize(this, 2500)">ğŸ’¥ Offre x3 (2500 DA)</div>
        </div>
        <br>
        <select id="wilaya" onchange="updateShipping()">
            <option value="">-- Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ„Ø§ÙŠØ© | Choisir Wilaya --</option>
        </select>
        <input id="phone" type="tel" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ | NÂ° de TÃ©lÃ©phone">
    </div>
</div>

<div class="price-bar">
    <div>
        <div style="color:#888;font-size:11px;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ | Total</div>
        <div class="total-price"><span id="totalDisplay">500</span> DA</div>
    </div>
    <button class="btn-order" onclick="sendWA()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ | Commander ğŸ“©</button>
</div>

<script>
// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„ØªÙˆÙ‚ÙŠØ¹
const canvas = document.getElementById('signature-pad');
const ctx = canvas.getContext('2d');
let writing = false;

function setupCanvas() {
    canvas.width = canvas.offsetWidth;
    canvas.height = canvas.offsetHeight;
    ctx.strokeStyle = "#000";
    ctx.lineWidth = 2;
    ctx.lineCap = "round";
}

canvas.addEventListener('touchstart', e => { writing = true; ctx.beginPath(); const rect = canvas.getBoundingClientRect(); ctx.moveTo(e.touches[0].clientX - rect.left, e.touches[0].clientY - rect.top); e.preventDefault(); });
canvas.addEventListener('touchmove', e => { if(!writing) return; const rect = canvas.getBoundingClientRect(); ctx.lineTo(e.touches[0].clientX - rect.left, e.touches[0].clientY - rect.top); ctx.stroke(); e.preventDefault(); });
canvas.addEventListener('touchend', () => writing = false);
// Ù„Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±
canvas.addEventListener('mousedown', e => { writing = true; ctx.beginPath(); ctx.moveTo(e.offsetX, e.offsetY); });
canvas.addEventListener('mousemove', e => { if(writing) { ctx.lineTo(e.offsetX, e.offsetY); ctx.stroke(); } });
canvas.addEventListener('mouseup', () => writing = false);

function clearSig() { ctx.clearRect(0, 0, canvas.width, canvas.height); }

window.onload = setupCanvas;

const wilayas = ["01- Adrar", "02- Chlef", "03- Laghouat", "04- Oum El Bouaghi", "05- Batna", "06- Bejaia", "07- Biskra", "08- Bechar", "09- Blida", "10- Bouira", "11- Tamanghasset", "12- Tebessa", "13- Tlemcen", "14- Tiaret", "15- Tizi Ouzou", "16- Alger", "17- Djelfa", "18- Jijel", "19- Setif", "20- Saida", "21- Skikda", "22- Sidi Bel Abbes", "23- Annaba", "24- Guelma", "25- Constantine", "26- Medea", "27- Mostaganem", "28- M'Sila", "29- Mascara", "30- Ouargla", "31- Oran", "32- El Bayadh", "33- Illizi", "34- B.B.Arreridj", "35- Boumerdes", "36- El Tarf", "37- Tindouf", "38- Tissemsilt", "39- El Oued", "40- Khenchela", "41- Souk Ahras", "42- Tipaza", "43- Mila", "44- Ain Defla", "45- Naama", "46- Ain Temouchent", "47- Ghardaia", "48- Relizane", "49- Timimoun", "50- B.B.Mokhtar", "51- Ouled Djellal", "52- Beni Abbes", "53- In Salah", "54- In Guezzam", "55- Touggourt", "56- Djanet", "57- El M'Ghair", "58- El Meniaa"];

const questionsData = [
    {id: 1, q: "Ù„Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø·Ø±ØŸ | Pour qui?", ops: ["Ø±Ø¬Ù„ | Homme", "Ø³ÙŠØ¯Ø© | Femme", "Ù„Ù„Ø¬Ù†Ø³ÙŠÙ† | Unisexe"]},
    {id: 2, q: "Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ© | IdentitÃ©", ops: ["ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ | Classique", "Ø¹ØµØ±ÙŠ | Moderne", "ØºØ§Ù…Ø¶ | MystÃ©rieux", "Ø±ÙŠØ§Ø¶ÙŠ | Sportif"]},
    {id: 3, q: "ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… | Moment", ops: ["ØµØ¨Ø§Ø­ÙŠ | Matin", "Ù…Ø³Ø§Ø¦ÙŠ | Soir", "Ù…Ù†Ø§Ø³Ø¨Ø§Øª | Occasion", "ÙŠÙˆÙ…ÙŠ | Quotidien"]},
    {id: 4, q: "Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø¹Ø·Ø±ÙŠØ© | Style de Parfum", ops: ["ÙØ±Ù†Ø³ÙŠØ© | FranÃ§ais", "Ù†ÙŠØ´ ÙØ®Ù… | Niche", "Ø³ÙƒØ±ÙŠ | Gourmand", "Ø®Ø´Ø¨ÙŠ | BoisÃ©", "Ø´Ø±Ù‚ÙŠ | Oriental"]},
    {id: 5, q: "Ù‚ÙˆØ© Ø§Ù„Ø­Ø¶ÙˆØ± | Sillage", ops: ["ÙÙˆØ§Ø­ | Puissant", "Ù‡Ø§Ø¯Ø¦ | Discret", "Ù…ØªØ²Ù† | Ã‰quilibrÃ©"]},
    {id: 6, q: "Ø§Ù„ØªÙˆÙ„ÙŠÙØ© | Composition", ops: ["Ø£Ø®Ø´Ø§Ø¨ | BoisÃ©", "Ø²Ù‡ÙˆØ± | Floral", "ÙÙˆØ§ÙƒÙ‡ | FruitÃ©", "ØªÙˆØ§Ø¨Ù„ | Ã‰picÃ©", "Ù…Ø§Ø¦ÙŠ | Aquatique"]},
    {id: 7, q: "Ø§Ù„ÙØµÙ„ | Saison", ops: ["Ø´ØªØ§Ø¡ | Hiver", "ØµÙŠÙ | Ã‰tÃ©", "Ø®Ø±ÙŠÙ | Automne", "Ø±Ø¨ÙŠØ¹ | Printemps"]},
    {id: 8, q: "Ø§Ù„Ù…ÙƒØ§Ù† | Lieu", ops: ["Ø§Ù„Ø¹Ù…Ù„ | Travail", "Ù„Ù‚Ø§Ø¡ | Rendez-vous", "Ø­ÙÙ„Ø© | FÃªte", "Ø§Ù„Ù†Ø§Ø¯ÙŠ | Sport"]},
    {id: 9, q: "Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© | Note de fond", ops: ["Ù…Ø³Ùƒ | Musc", "Ø¹Ù†Ø¨Ø± | Ambre", "Ø¹ÙˆØ¯ | Oud", "ÙØ§Ù†ÙŠÙ„ÙŠØ§ | Vanille", "Ø¨Ø§ØªØ´ÙˆÙ„ÙŠ | Patchouli"]},
    {id: 10, q: "Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…ÙØ¶Ù„ | Couleur PrÃ©fÃ©rÃ©e", ops: ["Ø£Ø³ÙˆØ¯ | Noir", "Ø£Ø¨ÙŠØ¶ | Blanc", "Ø£Ø²Ø±Ù‚ | Bleu", "Ø£Ø­Ù…Ø± | Rouge", "Ø£Ø®Ø¶Ø± | Vert"]},
    {id: 11, q: "Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø´Ø±Ø© | Type de peau", ops: ["Ø¬Ø§ÙØ© | SÃ¨che", "Ø¯Ù‡Ù†ÙŠØ© | Grasse", "Ù…Ø®ØªÙ„Ø·Ø© | Mixte", "Ø¹Ø§Ø¯ÙŠØ© | Normale"]},
    {id: 12, q: "Ø±Ø§Ø¦Ø­Ø© Ø§Ù„Ù†Ø¸Ø§ÙØ©ØŸ | Odeur de propre?", ops: ["Ù†Ø¹Ù… | Oui", "Ù„Ø§ | Non", "Ø®ÙÙŠÙ | LÃ©gÃ¨re"]},
    {id: 13, q: "Ø§Ù„Ø¹Ù…Ø± Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù | Tranche d'Ã¢ge", ops: ["Ø´Ø¨Ø§Ø¨ÙŠ | Jeune", "Ù†Ø§Ø¶Ø¬ | Mature", "Ù„Ù„Ø¬Ù…ÙŠØ¹ | Tout Ã¢ge"]},
    {id: 14, q: "Ø­Ù…Ø¶ÙŠØ§ØªØŸ | Agrumes?", ops: ["Ù†Ø¹Ù… | Oui", "Ù„Ø§ | Non", "Ø®ÙÙŠÙ | Un peu"]},
    {id: 15, q: "Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©ØŸ | PrioritÃ©?", ops: ["Ø§Ù„ÙÙˆØ­Ø§Ù† | Projection", "Ø§Ù„Ø«Ø¨Ø§Øª | Tenue", "Ø§Ù„ØªÙˆØ§Ø²Ù† | Ã‰quilibre"]},
    {id: 16, q: "Ø¹Ø·Ø± Ù…Ø³ØªÙˆØ­Ù‰ØŸ | Parfum inspirÃ©?", ops: ["Ù†Ø¹Ù… | Oui", "Ù„Ø§ | Non"]}
];

let selectedAnswers = {};
let currentProductPrice = 500;
let shipPrice = 0;

const selectWilaya = document.getElementById('wilaya');
wilayas.forEach(w => { let opt = document.createElement('option'); opt.value = w; opt.innerHTML = w; selectWilaya.appendChild(opt); });

const qContainer = document.getElementById('questions-container');
questionsData.forEach(item => {
    let html = `<div class="question-block"><span class="question-label">${item.id}- ${item.q}</span><div class="options-grid">`;
    item.ops.forEach(opt => { html += `<div class="option-box" onclick="selectOption(${item.id}, '${opt}', this)">${opt}</div>`; });
    qContainer.innerHTML += html + `</div></div>`;
});

function selectOption(id, val, el) {
    el.parentElement.querySelectorAll('.option-box').forEach(b => b.classList.remove('selected'));
    el.classList.add('selected');
    selectedAnswers[id] = val;
    if(id==1 || id==4) updateRecommendation();
}

function updateRecommendation() {
    const list = ["Toulifa Lab SpÃ©ciale", "CrÃ©ation Exclusive"];
    const recCard = document.getElementById('rec-card');
    const recList = document.getElementById('rec-list');
    recCard.style.display = 'block';
    recList.innerHTML = "";
    list.forEach(p => {
        let div = document.createElement('div');
        div.className = 'option-box';
        div.innerText = p;
        div.onclick = function() {
            recList.querySelectorAll('.option-box').forEach(b => b.classList.remove('selected'));
            div.classList.add('selected');
            document.getElementById('chosenPerfume').value = p;
        };
        recList.appendChild(div);
    });
}

function selectSize(el, price) {
    document.querySelectorAll('#size-options .option-box').forEach(b => b.classList.remove('selected'));
    el.classList.add('selected');
    currentProductPrice = price;
    updateTotal();
}

function updateShipping() {
    const w = document.getElementById("wilaya").value;
    if(w.includes("Medea")) shipPrice = 200;
    else if(w.includes("Alger") || w.includes("Blida")) shipPrice = 400;
    else shipPrice = 600;
    updateTotal();
}

function updateTotal() { document.getElementById("totalDisplay").textContent = currentProductPrice + shipPrice; }

function sendWA() {
    const w = document.getElementById("wilaya").value;
    const p = document.getElementById("phone").value;
    if(!w || !p) { alert("Veuillez remplir les informations"); return; }
    
    // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ ÙƒØµÙˆØ±Ø© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø±Ø³Ø§Ù„Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ù†Øµ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ØŒ Ù„ÙƒÙ†Ù†Ø§ Ø³Ù†Ø®Ø¨Ø±Ùƒ Ø¨ÙˆØ¬ÙˆØ¯Ù‡
    let msg = `*ğŸ”¬ Nouvelle Commande / Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯*\n` +
              `ğŸ‘¤ *Nom:* ${document.getElementById('bottleName').value}\n` +
              `âœ’ï¸ *Signature:* Ø§Ù„Ø²Ø¨ÙˆÙ† Ù‚Ø§Ù… Ø¨Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ ÙŠØ¯ÙˆÙŠØ§Ù‹\n` +
              `ğŸ“¦ *Taille:* ${document.querySelector('#size-options .selected').innerText}\n` +
              `ğŸ“ *Wilaya:* ${w}\n` +
              `ğŸ“ *TÃ©l:* ${p}\n\n` +
              `ğŸ’° *Total:* ${document.getElementById("totalDisplay").textContent} DA`;

    window.location.href = `https://wa.me/213783147002?text=${encodeURIComponent(msg)}`;
}
</script>
</body>
</html>
